(this.webpackJsonpvote=this.webpackJsonpvote||[]).push([[0],{75:function(e,t,n){},87:function(e,t,n){},88:function(e,t,n){"use strict";n.r(t);var o=n(4),i=n(2),r=n.n(i),c=n(65),a=n.n(c),s=(n(75),n(47)),l=n.n(s),u=n(66),d=n(10),j=n(11),b=r.a.createContext(),p=Object(j.createHttpLink)({uri:"http://berisuara.herokuapp.com"}),g=function(e){var t=e.children,n=r.a.useContext(b).token,i=new j.ApolloLink((function(e,t){return e.setContext({headers:{"Event-Authorization":n}}),t(e)})),c=new j.ApolloClient({link:i.concat(p),cache:new j.InMemoryCache,defaultOptions:{mutate:{errorPolicy:"all"},query:{errorPolicy:"all"}}});return Object(o.jsx)(j.ApolloProvider,{client:c,children:t})},f=n(29),h=n(9),x={container:{backgroundColor:"#A74242",padding:"18px 24px"},title:{fontStyle:"normal",fontWeight:"normal",fontSize:"24px",lineHeight:"29px",color:"#FDF5F5"}},v=function(e){var t=e.title;return Object(o.jsx)("div",{style:x.container,children:Object(o.jsx)("span",{style:x.title,children:t})})},m=n.p+"static/media/background.80277337.png",O={parentContainer:{height:"100vh",backgroundImage:"url(".concat(m,")"),backgroundSize:"cover"},container:{display:"flex",height:"80vh",flexDirection:"row",alignItems:"center",justifyContent:"center",padding:10},button:{padding:"8px 24px",backgroundColor:"#A74242",borderRadius:"20px",border:"none",fontSize:15,color:"white",margin:20},text:{fontWeight:"bold",fontSize:"20px",color:"white",textAlign:"center"},buttonWrapper:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:10}},y=function(){var e=Object(h.f)(),t=function(t){t.preventDefault(),e.push(t.target.id)};return Object(o.jsxs)("div",{style:O.parentContainer,children:[Object(o.jsx)(v,{title:"Pemira Himafi"}),Object(o.jsxs)("div",{style:O.container,children:[Object(o.jsx)("input",{style:O.button,id:"kahim",type:"button",value:"Pilih Kahim",onClick:t}),Object(o.jsx)("input",{style:O.button,id:"senator",type:"button",value:"Pilih Senator",onClick:t})]})]})},C=n(27),k=n(50),S={container:{display:"flex",alignItems:"center",flexDirection:"row"},choiceContainer:{display:"flex",alignItems:"center",flexDirection:"column",margin:20},image:{height:150},text:{fontWeight:"bold",fontSize:"18px",color:"white",textAlign:"center"}},I=function(e){var t=e.data,n=e.onChange,i=r.a.useState(""),c=Object(d.a)(i,2),a=c[0],s=c[1],l=function(e){s(e.target.value),t.map((function(t){return t.id===e.target.value&&n(t),""}))},u=t.map((function(e){var t=e.name.lastIndexOf(" "),n=e.name.substring(0,t),i=e.name.split(" ").pop();return Object(o.jsxs)("div",{style:S.choiceContainer,children:[Object(o.jsx)("img",{src:e.picture||"",style:S.image,alt:e.name}),Object(o.jsxs)("p",{style:S.text,children:[n,Object(o.jsx)("br",{}),i]}),Object(o.jsx)("input",{type:"radio",value:e.id,checked:a===e.id,onChange:l})]},e.id)}));return Object(o.jsx)("div",{style:S.container,children:u})};function w(){var e=Object(C.a)(["\n    mutation($code: String!, $choiceID: ID!){\n        vote(eventCode: $code, choiceID: $choiceID){\n            id\n            votedRegistrantsCount\n            choices{\n                id\n                voteCount\n            }\n        }        \n    }\n"]);return w=function(){return e},e}function z(){var e=Object(C.a)(["\n    query($code: String!){\n        getEventByCode(code:$code){\n            id\n            name\n            picture\n            status\n            choices{\n              id\n              name\n              picture\n            }\n        }\n        myVote(eventCode: $code)\n    }\n"]);return z=function(){return e},e}var D={parentContainer:{height:"100vh",backgroundImage:"url(".concat(m,")"),backgroundSize:"cover"},container:{display:"flex",height:"80vh",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:10},button:{padding:"8px 24px",backgroundColor:"#A74242",borderRadius:"20px",border:"none",fontSize:15,color:"white",margin:20},text:{fontWeight:"bold",fontSize:"20px",color:"white",textAlign:"center"},buttonWrapper:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:10}},$=Object(j.gql)(z()),A=Object(j.gql)(w()),E=function(){var e=r.a.useState(null),t=Object(d.a)(e,2),n=t[0],i=t[1],c=r.a.useState(!1),a=Object(d.a)(c,2),s=a[0],l=a[1],u=Object(j.useMutation)(A),b=Object(d.a)(u,1)[0],p=Object(h.g)().eventCode,g=Object(h.f)(),f=Object(j.useQuery)($,{variables:{code:p}}),x=f.data,m=f.error;r.a.useEffect((function(){m&&g.replace("/"+p),!x||"closed"!==x.getEventByCode.status&&!0!==x.myVote||g.replace("/"+p)}),[x,m,p,g]);return x?Object(o.jsxs)("div",{style:D.parentContainer,children:[Object(o.jsx)(v,{title:"Pemira Himafi"}),s?Object(o.jsxs)("div",{style:D.container,children:[Object(o.jsx)("span",{style:D.text,children:"Are you sure with your choice?"}),Object(o.jsxs)("div",{style:D.buttonWrapper,children:[Object(o.jsx)("input",{style:Object(k.a)(Object(k.a)({},D.button),{},{backgroundColor:"green"}),type:"button",value:"Submit",onClick:function(){b({variables:{code:p,choiceID:n.id}}).then((function(){g.replace("/"+p)}))}}),Object(o.jsx)("input",{style:D.button,type:"button",value:"Cancel",onClick:function(){l(!1)}})]})]}):Object(o.jsxs)("div",{style:D.container,children:[Object(o.jsxs)("p",{children:["vote: ",p]}),Object(o.jsx)(I,{data:x.getEventByCode.choices,onChange:function(e){i(e)}}),Object(o.jsx)("input",{style:D.button,type:"button",value:"Vote",onClick:function(){l(!0)},disabled:!n})]})]}):Object(o.jsx)("div",{style:D.parentContainer,children:Object(o.jsx)(v,{title:"Pemira Himafi"})})},P={display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"70%",padding:24},T={padding:"8px 0",width:"60%",textAlign:"center",fontSize:18,border:"0.8px solid #7C7C7C",borderRadius:20},B={padding:"8px 24px",backgroundColor:"#A74242",borderRadius:"20px",border:"none",fontSize:15,color:"white",marginTop:16};function R(){var e=Object(C.a)(["\n    mutation($code: String!, $ticket: String!){\n        verifyCode(code: $code, ticket: $ticket)\n    }\n"]);return R=function(){return e},e}function W(){var e=Object(C.a)(["\n    mutation($code: String!, $id: String!){\n        verifyRegistrant(eventCode: $code, id: $id){\n            ticket\n            email\n        }\n    }\n"]);return W=function(){return e},e}var q={parentContainer:{height:"100vh",backgroundImage:"url(".concat(m,")"),backgroundSize:"cover"},container:{display:"flex",height:"80vh",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:10}},F=Object(j.gql)(W()),H=Object(j.gql)(R()),L=function(){var e=Object(h.f)(),t=Object(h.g)().eventCode,n=r.a.useState(""),i=Object(d.a)(n,2),c=i[0],a=i[1],s=r.a.useState(""),l=Object(d.a)(s,2),u=l[0],p=l[1],g=r.a.useState(""),f=Object(d.a)(g,2),x=f[0],m=f[1],O=r.a.useState(""),y=Object(d.a)(O,2),C=y[0],k=y[1],S=r.a.useState(""),I=Object(d.a)(S,2),w=I[0],z=I[1],D=r.a.useContext(b).setToken,$=Object(j.useMutation)(F),A=Object(d.a)($,1)[0],E=Object(j.useMutation)(H),R=Object(d.a)(E,1)[0];r.a.useEffect((function(){z("")}),[x,c,u]);return Object(o.jsxs)("div",{style:q.parentContainer,children:[Object(o.jsx)(v,{title:"Pemira Himafi"}),Object(o.jsxs)("form",{style:P,children:[Object(o.jsx)("span",{style:{fontWeight:"normal",fontSize:"".concat(""===x?"24px":"18px"),marginBottom:40,color:"white",textAlign:"center"},children:""===x?"Enter Your NIM":"Verification code has been sent to ".concat(C)}),Object(o.jsx)("input",{type:"text",style:T,placeholder:""===x?"NIM":"Code",value:""===x?c:u,onChange:""===x?function(e){a(e.target.value)}:function(e){p(e.target.value)}}),Object(o.jsx)("span",{style:{color:"red",marginTop:12},children:w}),Object(o.jsx)("button",{type:"submit",style:B,onClick:""===x?function(e){e.preventDefault(),A({variables:{code:t,id:c}}).then((function(e){var t=e.data,n=e.errors;if(n){var o=n[0].message;z("unauthorized"===o?"You are not registered in this event.":o)}else m(t.verifyRegistrant.ticket),k(t.verifyRegistrant.email)}))}:function(n){n.preventDefault(),R({variables:{code:u,ticket:x}}).then((function(n){var o=n.data,i=n.errors;if(i){var r=i[0].message;z("unauthorized"===r?"Code already expired. Please reload the page.":r)}else D(o.verifyCode),e.replace("/"+t)}))},children:"Enter"})]})]})},M={container:{height:"100vh",backgroundImage:"url(".concat(m,")"),display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},text:{fontWeight:"normal",fontSize:"24px",marginBottom:40,color:"white",textAlign:"center"}},V=function(){return Object(o.jsx)("div",{style:M.container,children:Object(o.jsx)("span",{style:M.text,children:"Not Found"})})};function Q(){var e=Object(C.a)(["\n    query($code: String!){\n        getEventByCode(code:$code){\n            id\n            name\n            picture\n            status\n            registrantsCount\n            votedRegistrantsCount\n            choices{\n              id\n              name\n              picture\n              voteCount\n            }\n        }\n        myVote(eventCode: $code)\n    }\n"]);return Q=function(){return e},e}var N={parentContainer:{height:"100vh",backgroundImage:"url(".concat(m,")"),backgroundSize:"cover"},container:{display:"flex",height:"80vh",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:10},text:{fontWeight:"normal",fontSize:"24px",marginBottom:40,color:"white",textAlign:"center"},button:{padding:"8px 24px",backgroundColor:"#A74242",borderRadius:"20px",border:"none",fontSize:15,color:"white",marginTop:16}},Y=Object(j.gql)(Q()),J=function(){var e=Object(h.f)(),t=r.a.useState(!0),n=Object(d.a)(t,2),i=n[0],c=n[1],a=r.a.useContext(b).removeToken,s=Object(h.g)().eventCode,l=Object(j.useQuery)(Y,{variables:{code:s}}),u=l.data,p=l.error,g=l.refetch;r.a.useEffect((function(){p&&"event not found"===p.graphQLErrors[0].message&&c(!1),p&&"unauthorized"===p.graphQLErrors[0].message&&e.replace(s+"/verify"),u&&"open"===u.getEventByCode.status&&!1===u.myVote&&e.replace(s+"/vote")}),[u,p,s,e]),r.a.useEffect((function(){g()}),[e,g]);return i?u?Object(o.jsxs)("div",{style:N.parentContainer,children:[Object(o.jsx)(v,{title:"Pemira Himafi"}),Object(o.jsxs)("div",{style:N.container,children:[Object(o.jsx)("span",{style:N.text,children:"You already used your vote"}),Object(o.jsxs)("span",{style:N.text,children:["Thank you for your participation on ",u.getEventByCode.name]}),Object(o.jsx)("input",{type:"button",value:"Logout",style:N.button,onClick:function(){a(),e.replace("")}})]})]}):Object(o.jsx)("div",{style:N.parentContainer,children:Object(o.jsx)(v,{title:"Pemira Himafi"})}):Object(o.jsx)(V,{})};n(87);var K=function(){var e=r.a.useState(""),t=Object(d.a)(e,2),n=t[0],i=t[1],c=r.a.useState(!0),a=Object(d.a)(c,2),s=a[0],j=a[1],p={token:n,setToken:function(e){localStorage.setItem("eventToken",e),i(e)},removeToken:function(){localStorage.removeItem("eventToken"),i("")}};return r.a.useEffect((function(){var e=function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,localStorage.getItem("eventToken");case 2:null!==(t=e.sent)&&i(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();j(!0),e(),j(!1)}),[]),s?Object(o.jsx)("div",{}):Object(o.jsx)(b.Provider,{value:p,children:Object(o.jsx)(g,{children:Object(o.jsx)(f.a,{basename:"/pemira",children:Object(o.jsxs)(h.c,{children:[Object(o.jsx)(h.a,{exact:!0,path:"/",component:y}),Object(o.jsx)(h.a,{exact:!0,path:"/:eventCode",component:J}),Object(o.jsx)(h.a,{exact:!0,path:"/:eventCode/vote",component:E}),Object(o.jsx)(h.a,{exact:!0,path:"/:eventCode/verify",component:L}),Object(o.jsx)(h.a,{exact:!0,path:"/*",component:V})]})})})})},G=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,90)).then((function(t){var n=t.getCLS,o=t.getFID,i=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),o(e),i(e),r(e),c(e)}))};a.a.render(Object(o.jsx)(r.a.StrictMode,{children:Object(o.jsx)(K,{})}),document.getElementById("root")),G()}},[[88,1,2]]]);
//# sourceMappingURL=main.4622573c.chunk.js.map