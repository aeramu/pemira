(this.webpackJsonpvote=this.webpackJsonpvote||[]).push([[0],{75:function(e,t,n){},87:function(e,t,n){},88:function(e,t,n){"use strict";n.r(t);var i=n(4),o=n(2),r=n.n(o),c=n(65),a=n.n(c),s=(n(75),n(47)),l=n.n(s),u=n(66),d=n(10),j=n(11),b=r.a.createContext(),p=Object(j.createHttpLink)({uri:"https://berisuara.herokuapp.com"}),f=function(e){var t=e.children,n=r.a.useContext(b).token,o=new j.ApolloLink((function(e,t){return e.setContext({headers:{"Event-Authorization":n}}),t(e)})),c=new j.ApolloClient({link:o.concat(p),cache:new j.InMemoryCache,defaultOptions:{mutate:{errorPolicy:"all"},query:{errorPolicy:"all"}}});return Object(i.jsx)(j.ApolloProvider,{client:c,children:t})},g=n(29),h=n(9),x={container:{backgroundColor:"#A74242",padding:"18px 24px"},title:{fontStyle:"normal",fontWeight:"normal",fontSize:"24px",lineHeight:"29px",color:"#FDF5F5"}},v=function(e){e.title;return Object(i.jsx)("div",{style:x.container,children:Object(i.jsx)("span",{style:x.title,children:"PEMIRA HIMAFI"})})},m=n.p+"static/media/background.80277337.png",O={parentContainer:{height:"100vh",backgroundImage:"url(".concat(m,")"),backgroundSize:"cover"},container:{display:"flex",height:"80vh",flexDirection:"row",alignItems:"center",justifyContent:"center",padding:10},button:{padding:"8px 24px",backgroundColor:"#A74242",borderRadius:"20px",border:"none",fontSize:15,color:"white",margin:20},text:{fontWeight:"bold",fontSize:"20px",color:"white",textAlign:"center"},buttonWrapper:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:10}},y=function(){var e=Object(h.f)(),t=function(t){t.preventDefault(),e.push(t.target.id)};return Object(i.jsxs)("div",{style:O.parentContainer,children:[Object(i.jsx)(v,{title:"Pemira Himafi"}),Object(i.jsxs)("div",{style:O.container,children:[Object(i.jsx)("input",{style:O.button,id:"kahim",type:"button",value:"Pilih Kahim",onClick:t}),Object(i.jsx)("input",{style:O.button,id:"senator",type:"button",value:"Pilih Senator",onClick:t})]})]})},C=n(27),k=n(50),S={container:{display:"flex",alignItems:"center",flexDirection:"row"},choiceContainer:{display:"flex",alignItems:"center",flexDirection:"column",margin:20},image:{height:150},text:{fontWeight:"bold",fontSize:"18px",color:"white",textAlign:"center"}},I=function(e){var t=e.data,n=e.onChange,o=r.a.useState(""),c=Object(d.a)(o,2),a=c[0],s=c[1],l=function(e){s(e.target.value),t.map((function(t){return t.id===e.target.value&&n(t),""}))},u=t.map((function(e){var t=e.name.lastIndexOf(" "),n=e.name.substring(0,t),o=e.name.split(" ").pop();return Object(i.jsxs)("div",{style:S.choiceContainer,children:[Object(i.jsx)("img",{src:e.picture||"",style:S.image,alt:e.name}),Object(i.jsxs)("p",{style:S.text,children:[n,Object(i.jsx)("br",{}),o]}),Object(i.jsx)("input",{type:"radio",value:e.id,checked:a===e.id,onChange:l})]},e.id)}));return Object(i.jsx)("div",{style:S.container,children:u})};function w(){var e=Object(C.a)(["\n    mutation($code: String!, $choiceID: ID!){\n        vote(eventCode: $code, choiceID: $choiceID){\n            id\n            votedRegistrantsCount\n            choices{\n                id\n                voteCount\n            }\n        }        \n    }\n"]);return w=function(){return e},e}function z(){var e=Object(C.a)(["\n    query($code: String!){\n        getEventByCode(code:$code){\n            id\n            name\n            picture\n            status\n            choices{\n              id\n              name\n              picture\n            }\n        }\n        myVote(eventCode: $code)\n    }\n"]);return z=function(){return e},e}var A={parentContainer:{height:"100vh",backgroundImage:"url(".concat(m,")"),backgroundSize:"cover"},container:{display:"flex",height:"80vh",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:10},button:{padding:"8px 24px",backgroundColor:"#A74242",borderRadius:"20px",border:"none",fontSize:15,color:"white",margin:20},text:{fontWeight:"bold",fontSize:"20px",color:"white",textAlign:"center"},buttonWrapper:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:10}},D=Object(j.gql)(z()),E=Object(j.gql)(w()),$=function(){var e=r.a.useState(null),t=Object(d.a)(e,2),n=t[0],o=t[1],c=r.a.useState(!1),a=Object(d.a)(c,2),s=a[0],l=a[1],u=Object(j.useMutation)(E),b=Object(d.a)(u,1)[0],p=Object(h.g)().eventCode,f=Object(h.f)(),g=Object(j.useQuery)(D,{variables:{code:p}}),x=g.data,m=g.error;r.a.useEffect((function(){m&&f.replace("/"+p),!x||"closed"!==x.getEventByCode.status&&!0!==x.myVote||f.replace("/"+p)}),[x,m,p,f]);return x?Object(i.jsxs)("div",{style:A.parentContainer,children:[Object(i.jsx)(v,{title:"Pemira Himafi"}),s?Object(i.jsxs)("div",{style:A.container,children:[Object(i.jsx)("span",{style:A.text,children:"Are you sure with your choice?"}),Object(i.jsxs)("div",{style:A.buttonWrapper,children:[Object(i.jsx)("input",{style:Object(k.a)(Object(k.a)({},A.button),{},{backgroundColor:"green"}),type:"button",value:"Submit",onClick:function(){b({variables:{code:p,choiceID:n.id}}).then((function(){f.replace("/"+p)}))}}),Object(i.jsx)("input",{style:A.button,type:"button",value:"Cancel",onClick:function(){l(!1)}})]})]}):Object(i.jsxs)("div",{style:A.container,children:[Object(i.jsxs)("p",{children:["vote: ",p]}),Object(i.jsx)(I,{data:x.getEventByCode.choices,onChange:function(e){o(e)}}),Object(i.jsx)("input",{style:A.button,type:"button",value:"Vote",onClick:function(){l(!0)},disabled:!n})]})]}):Object(i.jsx)("div",{style:A.parentContainer,children:Object(i.jsx)(v,{title:"Pemira Himafi"})})},P={display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"70%",padding:24},T={padding:"8px 0",width:"60%",textAlign:"center",fontSize:18,border:"0.8px solid #7C7C7C",borderRadius:20},B={padding:"8px 24px",backgroundColor:"#A74242",borderRadius:"20px",border:"none",fontSize:15,color:"white",marginTop:16};function R(){var e=Object(C.a)(["\n    mutation($code: String!, $ticket: String!){\n        verifyCode(code: $code, ticket: $ticket)\n    }\n"]);return R=function(){return e},e}function H(){var e=Object(C.a)(["\n    mutation($code: String!, $id: String!){\n        verifyRegistrant(eventCode: $code, id: $id){\n            ticket\n            email\n        }\n    }\n"]);return H=function(){return e},e}var W={parentContainer:{height:"100vh",backgroundImage:"url(".concat(m,")"),backgroundSize:"cover"},container:{display:"flex",height:"80vh",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:10}},F=Object(j.gql)(H()),M=Object(j.gql)(R()),q=function(){var e=Object(h.f)(),t=Object(h.g)().eventCode,n=r.a.useState(""),o=Object(d.a)(n,2),c=o[0],a=o[1],s=r.a.useState(""),l=Object(d.a)(s,2),u=l[0],p=l[1],f=r.a.useState(""),g=Object(d.a)(f,2),x=g[0],m=g[1],O=r.a.useState(""),y=Object(d.a)(O,2),C=y[0],k=y[1],S=r.a.useState(""),I=Object(d.a)(S,2),w=I[0],z=I[1],A=r.a.useContext(b).setToken,D=Object(j.useMutation)(F),E=Object(d.a)(D,1)[0],$=Object(j.useMutation)(M),R=Object(d.a)($,1)[0];r.a.useEffect((function(){z("")}),[x,c,u]);return Object(i.jsxs)("div",{style:W.parentContainer,children:[Object(i.jsx)(v,{title:"Pemira Himafi"}),Object(i.jsxs)("form",{style:P,children:[Object(i.jsx)("span",{style:{fontWeight:"normal",fontSize:"".concat(""===x?"24px":"18px"),marginBottom:40,color:"white",textAlign:"center"},children:""===x?"Enter Your NIM":"Verification code has been sent to ".concat(C)}),Object(i.jsx)("input",{type:"text",style:T,placeholder:""===x?"NIM":"Code",value:""===x?c:u,onChange:""===x?function(e){a(e.target.value)}:function(e){p(e.target.value)}}),Object(i.jsx)("span",{style:{color:"red",marginTop:12},children:w}),Object(i.jsx)("button",{type:"submit",style:B,onClick:""===x?function(e){e.preventDefault(),E({variables:{code:t,id:c}}).then((function(e){var t=e.data,n=e.errors;if(n){var i=n[0].message;z("unauthorized"===i?"You are not registered in this event.":i)}else m(t.verifyRegistrant.ticket),k(t.verifyRegistrant.email)}))}:function(n){n.preventDefault(),R({variables:{code:u,ticket:x}}).then((function(n){var i=n.data,o=n.errors;if(o){var r=o[0].message;z("unauthorized"===r?"Code already expired. Please reload the page.":r)}else A(i.verifyCode),e.replace("/"+t)}))},children:"Enter"})]})]})},L={container:{height:"100vh",backgroundImage:"url(".concat(m,")"),display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},text:{fontWeight:"normal",fontSize:"24px",marginBottom:40,color:"white",textAlign:"center"}},V=function(){return Object(i.jsxs)("div",{style:L.container,children:[Object(i.jsx)(v,{title:"Pemira Himafi"}),Object(i.jsx)("span",{style:L.text,children:"Not Found"})]})};function Q(){var e=Object(C.a)(["\n    query($code: String!){\n        getEventByCode(code:$code){\n            id\n            name\n            picture\n            status\n            registrantsCount\n            votedRegistrantsCount\n            choices{\n              id\n              name\n              picture\n              voteCount\n            }\n        }\n        myVote(eventCode: $code)\n    }\n"]);return Q=function(){return e},e}var N={parentContainer:{height:"100vh",backgroundImage:"url(".concat(m,")"),backgroundSize:"cover"},container:{display:"flex",height:"80vh",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:10},text:{fontWeight:"normal",fontSize:"24px",marginBottom:40,color:"white",textAlign:"center"},button:{padding:"8px 24px",backgroundColor:"#A74242",borderRadius:"20px",border:"none",fontSize:15,color:"white",marginTop:16}},Y=Object(j.gql)(Q()),J=function(){var e=Object(h.f)(),t=r.a.useState(!0),n=Object(d.a)(t,2),o=n[0],c=n[1],a=r.a.useContext(b).removeToken,s=Object(h.g)().eventCode,l=Object(j.useQuery)(Y,{variables:{code:s}}),u=l.data,p=l.error,f=l.refetch;r.a.useEffect((function(){p&&"event not found"===p.graphQLErrors[0].message&&c(!1),p&&"unauthorized"===p.graphQLErrors[0].message&&e.replace(s+"/verify"),u&&"open"===u.getEventByCode.status&&!1===u.myVote&&e.replace(s+"/vote")}),[u,p,s,e]),r.a.useEffect((function(){f()}),[e,f]);return o?u?Object(i.jsxs)("div",{style:N.parentContainer,children:[Object(i.jsx)(v,{title:"Pemira Himafi"}),Object(i.jsxs)("div",{style:N.container,children:[Object(i.jsx)("span",{style:N.text,children:"You already used your vote"}),Object(i.jsxs)("span",{style:N.text,children:["Thank you for your participation on ",u.getEventByCode.name]}),Object(i.jsx)("input",{type:"button",value:"Logout",style:N.button,onClick:function(){a(),e.replace("")}})]})]}):Object(i.jsx)("div",{style:N.parentContainer,children:Object(i.jsx)(v,{title:"Pemira Himafi"})}):Object(i.jsx)(V,{})};n(87);var K=function(){var e=r.a.useState(""),t=Object(d.a)(e,2),n=t[0],o=t[1],c=r.a.useState(!0),a=Object(d.a)(c,2),s=a[0],j=a[1],p={token:n,setToken:function(e){localStorage.setItem("eventToken",e),o(e)},removeToken:function(){localStorage.removeItem("eventToken"),o("")}};return r.a.useEffect((function(){var e=function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,localStorage.getItem("eventToken");case 2:null!==(t=e.sent)&&o(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();j(!0),e(),j(!1)}),[]),s?Object(i.jsx)("div",{}):Object(i.jsx)(b.Provider,{value:p,children:Object(i.jsx)(f,{children:Object(i.jsx)(g.a,{basename:"pemira",children:Object(i.jsxs)(h.c,{children:[Object(i.jsx)(h.a,{exact:!0,path:"/",component:y}),Object(i.jsx)(h.a,{exact:!0,path:"/:eventCode",component:J}),Object(i.jsx)(h.a,{exact:!0,path:"/:eventCode/vote",component:$}),Object(i.jsx)(h.a,{exact:!0,path:"/:eventCode/verify",component:q}),Object(i.jsx)(h.a,{exact:!0,path:"/*",component:V})]})})})})},G=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,90)).then((function(t){var n=t.getCLS,i=t.getFID,o=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),i(e),o(e),r(e),c(e)}))};a.a.render(Object(i.jsx)(r.a.StrictMode,{children:Object(i.jsx)(K,{})}),document.getElementById("root")),G()}},[[88,1,2]]]);
//# sourceMappingURL=main.a804b562.chunk.js.map